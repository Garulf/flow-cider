---
name: "Setup Python"
description: "Set up a specific version of Python and add the command-line tools to the PATH."
author: "GitHub"
inputs:
  python-version:
    description: "Version range or exact version of a Python version to use, using SemVer's version range syntax."
    default: "3.x"
runs:
  - name: Setup Python
    uses: actions/setup-python@v2
    with:
      python-version: ${{ env.PYTHON_VER }}
  - uses: actions/cache@v3
    with:
      path: ~/.cache/pip
      key: ${{ runner.os }}-pip-${{ hashFiles('**/requirements_dev.txt') }}
      restore-keys: |
        ${{ runner.os }}-pip-
  - name: Install Dev Dependencies
    shell: bash
    run: |
      python -m pip install --upgrade pip
      pip install -r requirements_dev.txt
  - name: Build
    shell: bash
    run: |
      python ./bin/build.py --zip
  - name: Find zip file
    id: find
    run: |
      echo "::set-output name=prop::$(find . -name '*.zip')"
  - name: Get version
    id: version
    run: |
      echo "::set-output name=prop::$(python ./bin/build.py --version)"
  - name: Publish
    uses: softprops/action-gh-release@v1
    with:
      draft: false
      files: "${{ steps.find.outputs.prop }}"
      tag_name: "${{ steps.version.outputs.prop }}"
      generate_release_notes: true
      prerelease: "${{ contains(steps.version.outputs.prop, 'dev') || contains(steps.version.outputs.prop, 'rc') }}"
permissions:
contents: write
